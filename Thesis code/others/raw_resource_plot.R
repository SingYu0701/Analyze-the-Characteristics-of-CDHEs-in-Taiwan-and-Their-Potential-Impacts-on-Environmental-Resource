#----------------------------line plot----------------------
options(scipen = 999)
year<-c(2012:2024)
Keelung_energy<-c(677532110,675518803,684368708,672038252,715654529,715961875,
                  706905166,705847259,732230966,777392243,747436775,755291198,
                  777578442)
par(mgp = c(3.4, 0.5, 0), mar = c(5, 5, 4, 2))
plot(year, Keelung_energy/10000,
     type = "o",                    
     main = "(a) Annual Household Electricity Consumption in Keelung",
     xlab = "Year",
     ylab = "Electricity Consumption (x10000kWh)",
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)


Keelung_water<-c(783.1602083,807.591875,782.196875,783.1204167,
                 773.3239583,794.7058333,931.1485417,893.3602083,
                 900.2164583,867.0254167,846.7272917,743.0239583,
                 891.2604167
)
plot(year, Keelung_water,
     type = "o",                       
     main = "(a) Annual Average Reservoir Storage in Keelung",
     xlab = "Year",
     ylab = "Reservoir Storage (×10⁴ m³)", 
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Keelung_fish<-c(3426.0510,2887.6730,3385.0100,2533.3400, 
                2881.4450,4017.5540,2667.4630,2789.5750,
                3912.5000,3098.6850,2923.0008,2826.6500, 
                3545.7423 
)
plot(year, Keelung_fish,
     type = "o",                       
     main = "(a) Annual Inland Aquaculture Production in Yilan",
     xlab = "Year",
     ylab = "Production (metric tons)", 
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Keelung_rice<-c(1433774.000,1560217.000,1656120.000,1720001.000, 
                1622894.000,1610545.000,1648226.000,1514934.000, 
                1606208.000,1667315.000,1586565.871,1725284.106, 
                1760447.371)
par(mgp = c(3, 0.5, 0))
plot(year, Keelung_rice/100,
     type = "o",                       
     main = "(a) Annual Rice Production Value in Yilan",
     xlab = "Year",
     ylab = "Production Value (×100,000 NT$)",  
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Keelung_hot<-c(42,54,43,40,66,68,43,
               48,50,48,40,46,62)
plot(year, Keelung_hot,
     type = "o",                       
     main = "(a) Annual Number of Heat-Related Illness Cases in Keelung",
     xlab = "Year",
     ylab = "Number of Cases", 
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)

#########################
Hengchun_energy<-c(1449614749,1464666126,1497589718,1543092213,
                   1579941525,1477493151,1592700856,1607257683,
                   1684630772,1719266878,1713466633,1717660900,
                   1790850404
)
par(mgp = c(3.4, 0.5, 0), mar = c(5, 5, 4, 2))
plot(year, Hengchun_energy/10000,
     type = "o",                     
     main = "(b) Annual Household Electricity Consumption in Pingtung",
     xlab = "Year",
     ylab = "Electricity Consumption (x10000kWh)",
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)


Hengchun_water<-c(1726.202,1657.711042,1692.831458,1610.121458,
                  1760.208125,1720.922708,1729.583333,1706.870625,
                  1766.325625,1810.757708,1808.25,1760.481875,
                  1543.460417
)
plot(year, Hengchun_water,
     type = "o",                       
     main = "(b) Annual Average Reservoir Storage in Hengchun",
     xlab = "Year",
     ylab = "Reservoir Storage (×10⁴ m³)", 
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Hengchun_fish<-c(38194.7190,42654.4675,39618.6260,32335.0700, 
                 29121.8260,34996.5380,37930.4340,36250.5250, 
                 35351.5599,31947.0163,29626.4735,30924.3635, 
                 28806.3839 
)
plot(year, Hengchun_fish,
     type = "o",                       
     main = "(b) Annual Inland Aquaculture Production in Pingtung",
     xlab = "Year",
     ylab = "Production (metric tons)", 
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Hengchun_rice<-c(1079763.000,1028801.000,1123414.000,1103096.000, 
                 1149726.000,1172854.000,1065566.000,996618.000, 
                 996617.000,1047720.000,921787.000,1169988.233,
                 1114861.126 
)
par(mgp = c(3, 0.5, 0))
plot(year, Hengchun_rice/100,
     type = "o",                       
     main = "(b) Annual Rice Production Value in Pingtung",
     xlab = "Year",
     ylab = "Production Value (×100,000 NT$)",  
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
Hengchun_hot<-c(67,67,71,120,200,154,136,119,
                200,129,156,199,264)
plot(year, Hengchun_hot,
     type = "o",                       
     main = "(b) Annual Number of Heat-Related Illness Cases in Pingtung",
     xlab = "Year",
     ylab = "Number of Cases",  
     col = "blue",
     lwd = 2,
     pch = 16,
     las = 1)
#############

oni <- c(
  0.96,0.72,0.53,0.3,0.14,-0.03,-0.24,-0.54,-0.81,-0.97,-1,-0.98,
  -0.9,-0.75,-0.59,-0.39,-0.31,-0.3,-0.27,-0.32,-0.35,-0.4,-0.45,-0.49,
  -0.5,-0.36,-0.1,0.28,0.75,1.22,1.6,1.9,2.14,2.33,2.4,2.39,
  2.24,1.93,1.44,0.99,0.45,-0.13,-0.78,-1.12,-1.31,-1.35,-1.48,-1.57,
  -1.55,-1.3,-1.07,-0.98,-1.02,-1.04,-1.1,-1.11,-1.16,-1.26,-1.46,-1.65,
  -1.66,-1.41,-1.07,-0.81,-0.71,-0.64,-0.55,-0.51,-0.55,-0.63,-0.75,-0.74,
  -0.68,-0.52,-0.44,-0.34,-0.25,-0.12,-0.08,-0.13,-0.19,-0.29,-0.35,-0.31,
  -0.15,0.03,0.09,0.2,0.43,0.65,0.79,0.86,1.01,1.21,1.31,1.14,
  0.92,0.63,0.38,-0.04,-0.26,-0.16,0.08,0.21,0.26,0.29,0.35,0.35,
  0.37,0.31,0.23,0.17,0.17,0.28,0.47,0.64,0.7,0.67,0.66,0.69,
  0.64,0.58,0.45,0.43,0.29,0.11,-0.06,-0.14,-0.11,-0.29,-0.57,-0.84,
  -0.85,-0.77,-0.57,-0.37,-0.14,-0.03,0.1,0.3,0.54,0.77,0.94,0.94,
  0.66,0.22,-0.12,-0.32,-0.38,-0.47,-0.56,-0.81,-1.07,-1.34,-1.5,-1.6,
  -1.64,-1.52,-1.29,-1.01,-0.84,-0.61,-0.37,-0.23,-0.24,-0.35,-0.55,-0.73,
  -0.85,-0.79,-0.61,-0.33,0.01,0.28,0.45,0.58,0.71,1.01,1.36,1.56,
  1.5,1.22,0.84,0.35,-0.17,-0.66,-1.05,-1.35,-1.56,-1.64,-1.64,-1.59,
  -1.42,-1.19,-0.93,-0.73,-0.55,-0.44,-0.48,-0.62,-0.83,-1.01,-1.09,-1.04,
  -0.86,-0.72,-0.59,-0.47,-0.26,-0.01,0.25,0.37,0.37,0.27,0.05,-0.21,
  -0.43,-0.43,-0.34,-0.3,-0.36,-0.41,-0.4,-0.32,-0.26,-0.18,-0.17,-0.27,
  -0.42,-0.46,-0.27,0.04,0.21,0.16,0.05,0.07,0.23,0.49,0.64,0.66,
  0.55,0.47,0.53,0.7,0.93,1.18,1.52,1.86,2.16,2.42,2.57,2.64,
  2.48,2.14,1.58,0.94,0.39,-0.07,-0.36,-0.54,-0.63,-0.69,-0.67,-0.56,
  -0.34,-0.16,0.05,0.2,0.3,0.31,0.14,-0.11,-0.38,-0.65,-0.84,-0.97,
  -0.92,-0.85,-0.7,-0.5,-0.22,-0.01,0.09,0.23,0.49,0.76,0.9,0.81,
  0.75,0.72,0.71,0.66,0.54,0.45,0.28,0.14,0.19,0.35,0.51,0.55,
  0.5,0.48,0.4,0.19,-0.08,-0.3,-0.41,-0.57,-0.89,-1.17,-1.27,-1.19,
  -1.05,-0.93,-0.84,-0.66,-0.48,-0.38,-0.4,-0.49,-0.67,-0.81,-0.98,-0.98,
  -0.97,-0.93,-0.99,-1.06,-0.99,-0.85,-0.81,-0.91,-1.01,-0.99,-0.92,-0.83,
  -0.68,-0.43,-0.15,0.16,0.48,0.77,1.07,1.32,1.56,1.78,1.92,1.95,
  1.78,1.48,1.14,0.71,0.39,0.15,0.04,-0.11,-0.21,-0.26,-0.37,-0.52
)

plot(oni, type = "o",
     main = "Monthly ONI index from 1995 to 2024",
     xlab = "Year",
     ylab = "ONI",
     col = "blue",
     lwd = 2,
     pch = 16,
     xaxt = "n") 

at_positions <- seq(1, length(oni), by = 24) 
years <- seq(1995, 2024, by = 2)

axis(1, at = at_positions, labels = FALSE, tck = -0.02)  
text(x = at_positions,
     y = par("usr")[3] - 0.05*diff(par("usr")[3:4]),  # 放在軸下方
     labels = years,
     srt = 45,     # 旋轉 45 度
     adj = 1,
     xpd = TRUE)
